-- Tạo bảng city
CREATE TABLE city
(
    id   SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL
);

-- Tạo bảng measurement
CREATE TABLE measurement
(
    id               SERIAL PRIMARY KEY,
    temperature      DOUBLE PRECISION NOT NULL,
    measurement_time DATE             NOT NULL,
    delete_flg       BOOLEAN          NOT NULL,
    city_id          BIGINT,
    FOREIGN KEY (city_id) REFERENCES city (id)
);

TRUNCATE TABLE _city RESTART IDENTITY CASCADE;

TRUNCATE TABLE _measurement RESTART IDENTITY CASCADE;

ALTER TABLE _city ADD CONSTRAINT unique_city_name UNIQUE (name);

SELECT COUNT(*)
FROM _city;

SELECT COUNT(*)
FROM _measurement;

-- Autogenerated: do not edit this file
DROP TABLE  IF EXISTS BATCH_STEP_EXECUTION_CONTEXT;
DROP TABLE  IF EXISTS BATCH_JOB_EXECUTION_CONTEXT;
DROP TABLE  IF EXISTS BATCH_STEP_EXECUTION;
DROP TABLE  IF EXISTS BATCH_JOB_EXECUTION_PARAMS;
DROP TABLE  IF EXISTS BATCH_JOB_EXECUTION;
DROP TABLE  IF EXISTS BATCH_JOB_INSTANCE;

DROP SEQUENCE  IF EXISTS BATCH_STEP_EXECUTION_SEQ;
DROP SEQUENCE  IF EXISTS BATCH_JOB_EXECUTION_SEQ;
DROP SEQUENCE  IF EXISTS BATCH_JOB_SEQ;


SELECT name, COUNT(*)
FROM _city
GROUP BY name
HAVING COUNT(*) > 1;